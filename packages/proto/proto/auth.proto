syntax = "proto3";
package auth;

service AuthService {
    rpc CredentialsRegister(RegisterRequest) returns (EmptyResponseWithStatus);
    rpc CredentialsLogin(CredentialsLoginRequest) returns (LoginResponse);
    rpc Logout(LogoutRequest) returns (EmptyResponseWithStatus);
    rpc RefreshTokens(RefreshTokensRequest) returns (RefreshTokensResponse);
    rpc ValidateAccessToken(ValidateTokenRequest) returns (ValidateTokenResponse);
}

message ValidateTokenRequest {
    string accessToken = 1;
}

message ValidateTokenResponse {
    string id = 1;
    string email = 2;
    string iat = 3;
    string exp = 4;
}

message RefreshTokensRequest {
    string agent = 1;
    string refreshToken = 2;
}

message RefreshTokensResponse {
    string accessToken = 1;
    RefreshToken refreshToken = 2;
}

message LogoutRequest {
    string refreshToken = 1;
}

message RegisterRequest {
    string fullName = 1;
    string email = 2;
    string password = 3;
}

enum ResponseStatus {
    OK = 0;
    ERROR = 1;
}
message EmptyResponseWithStatus {
    ResponseStatus status = 1;
    optional string error_message = 2;
}

message CredentialsLoginRequest {
    string email = 1;
    string password = 2;
    string agent = 3;
}

message Account {
    string id = 1;
    string fullName = 2;
    string email = 4;
}

message RefreshToken {
    string id = 1;
    string token = 2;
    string expInISOString = 3;
    string userAgent = 4;
}

message RefreshAndAccessTokens {
    RefreshToken refreshToken = 1;
    string accessToken = 2;
}

message LoginResponse {
    Account account = 1;
    RefreshAndAccessTokens tokens = 2;
}